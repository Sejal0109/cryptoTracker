<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HODLINFO</title>
</head>

<body style="
      padding: 0;
      margin: 0;
      box-sizing: border-box;
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS',
        sans-serif;
    ">
  <!-- navbar.......................................................... -->
  <div class="header" style="
        height: 38px;
        width: 100%;
        background-color: #191d28;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        padding-left: 25px;
        padding-right: 15px;
        position: fixed;
      ">
    <div class="compName" style="color: #3dc5c1; font-size: 30px">
      HODLINFO
    </div>
    <div class="navBut" style="
          display: flex;
          justify-content: space-between;
          padding: 10px;
          width: 180px;
        ">
      <div>
        <button style="
              background-color: #2f3241;
              color: #fffeff;
              border-radius: 5px;
              border: none;
              height: 25px;
            ">
          INR
          <img src="down-arrow.png" alt="down-arrow" style="height: 8px; width: 8px; color: #fffeff" />
        </button>
        <img />
      </div>
      <div>
        <button style="
              background-color: #2f3241;
              color: #fffeff;
              border-radius: 5px;
              border: none;
              height: 25px;
            ">
          BTC
          <img src="down-arrow.png" alt="down-arrow" style="height: 8px; width: 8px; color: #fffeff" />
        </button>
        <img />
      </div>
      <div>
        <button style="
              background-color: #2f3241;
              color: #fffeff;
              border-radius: 5px;
              border: none;
              height: 25px;
            ">
          BUY BTC
        </button>
        <img />
      </div>
    </div>
    <div class="connect" style="
          display: flex;
          padding: 10px;
          justify-content: space-between;
          padding-right: 35px;
        ">
      <div style="
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #191d28;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #3dc5c1;
            font-size: 14px;
            margin-right: 15px;
            border: 2px solid #3dc5c1;
          ">
        57
      </div>

      <button style="
            display: flex;
            align-items: center;
            background-color: #3dc5c1;
            color: white;
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            margin-right: 15px;
            height: 25px;
          ">
        <img src="telegram.png" alt="Telegram Icon" style="width: 16px; margin-right: 8px; color: #fffeff" />
        Connect Telegram
      </button>

      <div id="toggle-switch" style="
            position: relative;
            width: 45px;
            height: 24px;
            background-color: #2f3241;
            border-radius: 15px;
            cursor: pointer;
            transition: background-color 0.3s ease;
          ">
        <div style="
              position: absolute;
              top: 3px;
              left: 3px;
              width: 18px;
              height: 18px;
              background-color: #3dc5c1;
              border-radius: 50%;
              transition: transform 0.3s ease;
            "></div>
      </div>
    </div>
  </div>
  <!-- navbar end.......................................................... -->

  <!-- body start................................................................ -->
  <div class="body" style="
        background-color: #191d28;
        padding-left: 15px;
        padding-right: 15px;
        padding-top: 60px;
      ">
    <div>
      <div style="
            display: flex;
            align-items: center;
            justify-content: center;
            color: #7e8188;
            font-size: 20px;
          ">
        Best Price to Trade
      </div>

      <div style="display: flex; justify-content: space-around; padding: 20px 0">
        <div style="text-align: center">
          <div style="font-size: 24px; color: #3dc5c1">0.1%</div>
          <div style="font-size: 14px; color: #7e8188">5 Mins</div>
        </div>

        <div style="text-align: center">
          <div style="font-size: 24px; color: #3dc5c1">0.96%</div>
          <div style="font-size: 14px; color: #7e8188">1 Hour</div>
        </div>

        <div style="text-align: center">
          <div style="font-size: 50px; color: #fffeff">₹26,56,110</div>
          <div style="font-size: 14px; color: #7e8188; padding-top: 10px">
            Average BTC/INR net price including commission
          </div>
        </div>

        <div style="text-align: center">
          <div style="font-size: 24px; color: #3dc5c1">2.73%</div>
          <div style="font-size: 14px; color: #7e8188">1 Day</div>
        </div>

        <div style="text-align: center">
          <div style="font-size: 24px; color: #3dc5c1">7.51%</div>
          <div style="font-size: 14px; color: #7e8188">7 Days</div>
        </div>
      </div>
    </div>

    <table  style="
          width: 100%;
          border-collapse: separate;
          border-spacing: 0 10px;
          margin: 20px 0;
        ">
      <thead>
        <tr style="text-align: left">
          <th style="padding: 12px; color: #7e8188">#</th>
          <th style="padding: 12px; color: #7e8188">Platform</th>
          <th style="padding: 12px; color: #7e8188">Last Traded Price</th>
          <th style="padding: 12px; color: #7e8188">Buy / Sell Price</th>
          <th style="padding: 12px; color: #7e8188">Difference</th>
          <th style="padding: 12px; color: #7e8188">Savings</th>
        </tr>
      </thead>
      <tbody class="listView">
        <tr style="
              background-color: #2f3241;
              border-radius: 8px;
              overflow: hidden;
              color: #fffeff;
            ">
          <td style="padding: 12px; border-radius: 8px 0 0 8px">1</td>
          <td style="padding: 12px">
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRPoZnM5nE-Py6woqWNhLUW4Ymgcj6AX4AE4A&s"
              alt="WazirX" style="width: 20px; vertical-align: middle; margin-right: 8px" />
            WazirX
          </td>
          <td style="padding: 12px">₹ 25,72,612</td>
          <td style="padding: 12px">₹ 25,72,610 / ₹ 25,72,612</td>
          <td style="padding: 12px; color: #c35a60">-3.14%</td>
          <td style="padding: 12px; color: #c35a60; border-radius: 0 8px 8px 0">
            ▼ ₹ 83,498
          </td>
        </tr>

        <tr style="
              background-color: #2f3241;
              border-radius: 8px;
              overflow: hidden;
              color: #fffeff;
            ">
          <td style="padding: 12px; border-radius: 8px 0 0 8px">2</td>
          <td style="padding: 12px">
            <img src="bitbns.png" alt="Bitbns" style="width: 20px; vertical-align: middle; margin-right: 8px" />
            Bitbns
          </td>
          <td style="padding: 12px">₹ 28,83,906</td>
          <td style="padding: 12px">₹ 28,55,164 / ₹ 28,82,157</td>
          <td style="padding: 12px; color: #3dc5c1">8.58%</td>
          <td style="padding: 12px; color: #3dc5c1; border-radius: 0 8px 8px 0">
            ▲ ₹ 2,27,796
          </td>
        </tr>

        <tr style="
              background-color: #2f3241;
              border-radius: 8px;
              overflow: hidden;
              color: #fffeff;
            ">
          <td style="padding: 12px; border-radius: 8px 0 0 8px">3</td>
          <td style="padding: 12px">
            <img src="colodax.png" alt="Colodax" style="width: 20px; vertical-align: middle; margin-right: 8px" />
            Colodax
          </td>
          <td style="padding: 12px">₹ 25,46,035</td>
          <td style="padding: 12px">₹ 25,33,304 / ₹ 28,51,559</td>
          <td style="padding: 12px; color: #c35a60">-4.14%</td>
          <td style="padding: 12px; color: #c35a60; border-radius: 0 8px 8px 0">
            ▼ ₹ 1,10,074
          </td>
        </tr>

        <tr style="
              background-color: #2f3241;
              border-radius: 8px;
              overflow: hidden;
              color: #fffeff;
            ">
          <td style="padding: 12px; border-radius: 8px 0 0 8px">4</td>
          <td style="padding: 12px">
            <img src="zebpay.png" alt="Zebpay" style="width: 20px; vertical-align: middle; margin-right: 8px" />
            Zebpay
          </td>
          <td style="padding: 12px">₹ 26,50,000</td>
          <td style="padding: 12px">₹ 26,49,999 / ₹ 26,21,000</td>
          <td style="padding: 12px; color: #c35a60">-0.23%</td>
          <td style="padding: 12px; color: #c35a60; border-radius: 0 8px 8px 0">
            ▼ ₹ 6,110
          </td>
        </tr>

        <tr style="
              background-color: #2f3241;
              border-radius: 8px;
              overflow: hidden;
              color: #fffeff;
            ">
          <td style="padding: 12px; border-radius: 8px 0 0 8px">5</td>
          <td style="padding: 12px">
            <img src="zebpay.png" alt="Zebpay" style="width: 20px; vertical-align: middle; margin-right: 8px" />
            Zebpay
          </td>
          <td style="padding: 12px">₹ 26,50,000</td>
          <td style="padding: 12px">₹ 26,49,999 / ₹ 26,21,000</td>
          <td style="padding: 12px; color: #c35a60">-0.23%</td>
          <td style="padding: 12px; color: #c35a60; border-radius: 0 8px 8px 0">
            ▼ ₹ 6,110
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- body end................................................................ -->

  <!-- bottomNav start................................................................ -->
  <div class="bottomNav" style="
        display: flex;
        height: 36px;
        justify-content: center;
        align-items: center;
        background-color: #191d28;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 5;
        position: fixed;
      ">
    <button style="
          background-color: #191d28;
          border-radius: 5px;
          border-color: #3dc5c1;
          color: #3dc5c1;
          border-style: groove;
        ">
      Add hodlinfo to home screen
    </button>
  </div>
  <!-- bottomNav end................................................................ -->

  
</body>

<script>
  console.log("script file running!");

  async function fetchCryptoData() {
    try {
      const response = await fetch("http://localhost:3000/fetch-tickers");
      console.log("Fetched some crypto data!");
    } catch (error) {
      console.error("Error while adding data to db:", error);
    }
  }

  async function fetchTickers() {
    try {
      console.log("Called fetchTickers function");
      fetchCryptoData();
      const response = await fetch("http://localhost:3000/tickers");
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      const tickers = await response.json();

      console.log("Called fetchTickers function 2");

      const tableBody = document.querySelector(".listView");

      tableBody.innerHTML = ""; // Clear previous rows

      console.log("Called fetchTickers function 3");

      console.log(tickers);

      let i = 0;

      tickers.forEach((ticker) => {
        console.log("Called fetchTickers function !!");
        const row = document.createElement("tr");
        row.style.backgroundColor = "#2F3241";
        row.style.color = "#FFFEFF";
        row.style.overflow = "hidden";
        row.style.borderRadius = "8px";
        i++;
        row.innerHTML = `
           
                  <td style="padding: 12px; border-radius: 8px 0 0 8px;">${i}</td>
                  <td style="padding: 12px;">
                      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRPoZnM5nE-Py6woqWNhLUW4Ymgcj6AX4AE4A&s" alt="Zebpay" style="width: 20px; vertical-align: middle; margin-right: 8px;">
                      ${ticker.name}
                  </td>
                  <td style="padding: 12px;">₹ ${ticker.last}</td>
                  <td style="padding: 12px;">₹ ${ticker.buy} / ₹ ${ticker.sell}</td>
                  <td style="padding: 12px; color: #C35A60;">${ticker.volume}%</td>
                  <td style="padding: 12px; color: #C35A60; border-radius: 0 8px 8px 0;">▼ ₹ ${ticker.base_unit}</td>
             
        `;
        tableBody.appendChild(row);
      });
    } catch (error) {
      console.log("Error fetching data: ", error);
    }
  }

  fetchTickers();

  setInterval(fetchTickers, 1000 * 60);
</script>

</html>